#!/usr/bin/expect -f
set timeout 120
set password "Sipanda123#"
set host "157.10.252.74"
set user "sipanda"

# Transfer Python script
spawn scp /Users/pondokit/Herd/retribusi-api/gemini-cli/gemini-rotate.py $user@$host:/home/sipanda/gemini-rotate.py
expect {
    "password:" {
        send "$password\r"
        exp_continue
    }
    eof
}

# Transfer Keys file
spawn scp /Users/pondokit/Herd/retribusi-api/gemini-cli/.gemini_keys $user@$host:/home/sipanda/.gemini_keys
expect {
    "password:" {
        send "$password\r"
        exp_continue
    }
    eof
}

# Configure via SSH
spawn ssh $user@$host
expect "password:"
send "$password\r"
expect "$ "
send "chmod 600 /home/sipanda/.gemini_keys\r"
expect "$ "
send "echo \"alias gemini='python3 /home/sipanda/gemini-rotate.py'\" >> /home/sipanda/.bashrc\r"
expect "$ "
send "source /home/sipanda/.bashrc\r"
expect "$ "
send "exit\r"
expect eof
